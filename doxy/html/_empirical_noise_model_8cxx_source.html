<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>WireCellToolkit: gen/src/EmpiricalNoiseModel.cxx Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WireCellToolkit
   </div>
   <div id="projectbrief">Wire Cell Simulation, Signal Process and Reconstruction Toolki for Liquid Argon Detectors</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_empirical_noise_model_8cxx_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">EmpiricalNoiseModel.cxx</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_empirical_noise_model_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_empirical_noise_model_8h.html">WireCellGen/EmpiricalNoiseModel.h</a>&quot;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_configuration_8h.html">WireCellUtil/Configuration.h</a>&quot;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_persist_8h.html">WireCellUtil/Persist.h</a>&quot;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_exceptions_8h.html">WireCellUtil/Exceptions.h</a>&quot;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_response_8h.html">WireCellUtil/Response.h</a>&quot;</span> <span class="comment">// fixme: should remove direct dependency</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_named_factory_8h.html">WireCellUtil/NamedFactory.h</a>&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="_f_f_t_best_length_8h.html">WireCellUtil/FFTBestLength.h</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span>             <span class="comment">// debug</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<a class="code" href="_empirical_noise_model_8cxx.html#a2d3f3d46427dca1947cac1f0fc5f7000">WIRECELL_FACTORY</a>(EmpiricalNoiseModel, <a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html">WireCell::Gen::EmpiricalNoiseModel</a>,</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;                 <a class="code" href="class_wire_cell_1_1_i_channel_spectrum.html">WireCell::IChannelSpectrum</a>, <a class="code" href="class_wire_cell_1_1_i_configurable.html">WireCell::IConfigurable</a>)</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespace_wire_cell.html">WireCell</a>;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a3478b5daf202fbb7f923664ac21fdeb5">   21</a></span>&#160;<a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a3478b5daf202fbb7f923664ac21fdeb5">Gen::EmpiricalNoiseModel::EmpiricalNoiseModel</a>(<span class="keyword">const</span> std::string&amp; spectra_file,</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">int</span> nsamples,</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">double</span> period,</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">double</span> wire_length_scale,</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                          <span class="comment">// const double time_scale,</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                          <span class="comment">// const double gain_scale,</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                          <span class="comment">// const double freq_scale,</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                                              <span class="keyword">const</span> std::string anode_tn,</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                                              <span class="keyword">const</span> std::string chanstat_tn)</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    : m_spectra_file(spectra_file)</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    , m_nsamples(nsamples)</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    , m_period(period)</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    , m_wlres(wire_length_scale)</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// , m_tres(time_scale)</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// , m_gres(gain_scale)</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">// , m_fres(freq_scale)</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    , m_anode_tn(anode_tn)</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    , m_chanstat_tn(chanstat_tn)</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    , m_amp_cache(4)</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    , log(Log::<a class="code" href="namespace_wire_cell_1_1_log.html#a7675bcc4bf25b2bc66314d5c096cf676">logger</a>(<span class="stringliteral">&quot;sim&quot;</span>))</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  m_fft_length = <a class="code" href="namespace_wire_cell.html#abb6bcae83d0f22d52565724179e9dcd8">fft_best_length</a>(m_nsamples);</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="comment">//  m_fft_length = m_nsamples;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#abf5f2823eb9522997306417ddd1d9ca4">gen_elec_resp_default</a>();</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a4de4558ce8eb7aa69193a315741eadc6">   48</a></span>&#160;<a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a4de4558ce8eb7aa69193a315741eadc6">Gen::EmpiricalNoiseModel::~EmpiricalNoiseModel</a>()</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;{</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#abf5f2823eb9522997306417ddd1d9ca4">   52</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#abf5f2823eb9522997306417ddd1d9ca4">Gen::EmpiricalNoiseModel::gen_elec_resp_default</a>(){</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="comment">// double shaping[5]={1,1.1,2,2.2,3}; // us</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  </div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="comment">// calculate the frequencies ... </span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  m_elec_resp_freq.resize(m_fft_length,0);</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0;i!=m_elec_resp_freq.size();i++){</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordflow">if</span> (i&lt;=m_elec_resp_freq.size()/2.){</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      m_elec_resp_freq.at(i) = i / (m_elec_resp_freq.size() *1.0) * 1./m_period ; <span class="comment">// the second half is useless ... </span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      m_elec_resp_freq.at(i) = (m_elec_resp_freq.size()-i) / (m_elec_resp_freq.size() *1.0) * 1./m_period ; <span class="comment">// the second half is useless ... </span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    }</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      </div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">// if (m_elec_resp_freq.at(i) &gt; 1./m_period / 2.){</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="comment">//   m_elec_resp_freq.resize(i);</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="comment">//   break;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="comment">// }</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  }</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="comment">// for (int i=0;i!=5;i++){</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="comment">//   Response::ColdElec elec_resp(1, shaping[i]); // default at 1 mV/fC</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <span class="comment">//   auto sig   =   elec_resp.generate(WireCell::Waveform::Domain(0, m_fft_length*m_period), m_fft_length);</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="comment">//   auto filt   = Waveform::dft(sig);</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">//   int nconfig = shaping[i]/ 0.1;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="comment">//   auto ele_resp_amp = Waveform::magnitude(filt);</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">//   m_elec_resp_cache[nconfig] = ele_resp_amp;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="comment">// }</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;}</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;</div><div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a683bdf03c14c78ff74b12a844a688c61">   80</a></span>&#160;<a class="code" href="namespace_wire_cell.html#a9f705541fc1d46c608b3d32c182333ee">WireCell::Configuration</a> <a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a683bdf03c14c78ff74b12a844a688c61">Gen::EmpiricalNoiseModel::default_configuration</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="namespace_wire_cell.html#a9f705541fc1d46c608b3d32c182333ee">Configuration</a> cfg;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    cfg[<span class="stringliteral">&quot;spectra_file&quot;</span>] = m_spectra_file;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    cfg[<span class="stringliteral">&quot;nsamples&quot;</span>] = m_nsamples;          <span class="comment">// number of samples up to Nyquist frequency</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    cfg[<span class="stringliteral">&quot;period&quot;</span>] = m_period; </div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    cfg[<span class="stringliteral">&quot;wire_length_scale&quot;</span>] = m_wlres;    <span class="comment">// </span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <span class="comment">// cfg[&quot;time_scale&quot;] = m_tres;</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="comment">// cfg[&quot;gain_scale&quot;] = m_gres;</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="comment">// cfg[&quot;freq_scale&quot;] = m_fres;</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    cfg[<span class="stringliteral">&quot;anode&quot;</span>] = m_anode_tn;            <span class="comment">// name of IAnodePlane component</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">return</span> cfg;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a35db0e36d1426041740535fc2da0b07d">   97</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a35db0e36d1426041740535fc2da0b07d">Gen::EmpiricalNoiseModel::resample</a>(<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html">NoiseSpectrum</a>&amp; spectrum)<span class="keyword"> const</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  </div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordflow">if</span> (spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a29ae414d6739f6d639dfee7e7540a404">nsamples</a> == m_fft_length &amp;&amp; spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#aed82c7a61bd3901c3ad7dce02041f51e">period</a> == m_period) {</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    </div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// scale the amplitude ... </span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="namespace_wire_cell_1_1_waveform.html#aa8d25ae88346929b5e54cd116f7a4f47">scale</a> = sqrt(m_fft_length/(spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a29ae414d6739f6d639dfee7e7540a404">nsamples</a>*1.0) * spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#aed82c7a61bd3901c3ad7dce02041f51e">period</a> / (m_period*1.0));</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#aba73b1c4021bd3a684e89a1d873cf4bb">constant</a> *= <a class="code" href="namespace_wire_cell_1_1_waveform.html#aa8d25ae88346929b5e54cd116f7a4f47">scale</a>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ind = 0; ind!=spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a91705ef881cd5a2d5de2a09c397518da">amps</a>.size(); ind++){</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a91705ef881cd5a2d5de2a09c397518da">amps</a>[ind] *= <a class="code" href="namespace_wire_cell_1_1_waveform.html#aa8d25ae88346929b5e54cd116f7a4f47">scale</a>;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    </div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// interpolate ... </span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    </div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="class_wire_cell_1_1_i_channel_spectrum.html#a9af7bfed961f49dc8a532fd5d0bf3e6e">amplitude_t</a> temp_amplitudes(m_fft_length,0);</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">int</span> count_low  = 0;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="keywordtype">int</span> count_high = 1;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">double</span> mu=0;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i!=m_fft_length;i++){</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="keywordtype">double</span> frequency = m_elec_resp_freq.at(i);</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keywordflow">if</span> (frequency &lt;= spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a90d1860adb05adebe9650afd3e019f78">freqs</a>[0]){</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    count_low = 0;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        count_high = 1;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        mu = 0;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      }<span class="keywordflow">else</span> <span class="keywordflow">if</span> (frequency &gt;= spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a90d1860adb05adebe9650afd3e019f78">freqs</a>.back()){</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        count_low = spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a90d1860adb05adebe9650afd3e019f78">freqs</a>.size()-2;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        count_high = spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a90d1860adb05adebe9650afd3e019f78">freqs</a>.size()-1;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        mu = 1;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j=0;j!=spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a90d1860adb05adebe9650afd3e019f78">freqs</a>.size();j++){</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;      <span class="keywordflow">if</span> (frequency&gt;spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a90d1860adb05adebe9650afd3e019f78">freqs</a>.at(j)){</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        count_low = j;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        count_high = j+1;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      }<span class="keywordflow">else</span>{</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      }</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        mu = (frequency - spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a90d1860adb05adebe9650afd3e019f78">freqs</a>.at(count_low)) / (spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a90d1860adb05adebe9650afd3e019f78">freqs</a>.at(count_high)-spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a90d1860adb05adebe9650afd3e019f78">freqs</a>.at(count_low));</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      </div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      </div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      temp_amplitudes.at(i) = (1-mu) * spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a91705ef881cd5a2d5de2a09c397518da">amps</a>[count_low] + mu * spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a91705ef881cd5a2d5de2a09c397518da">amps</a>[count_high];</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      </div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a91705ef881cd5a2d5de2a09c397518da">amps</a> = temp_amplitudes;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a91705ef881cd5a2d5de2a09c397518da">amps</a>.push_back(spectrum.<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#aba73b1c4021bd3a684e89a1d873cf4bb">constant</a>);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    </div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#aa38f65fc1f32c8017f8205b32850074e">  150</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#aa38f65fc1f32c8017f8205b32850074e">Gen::EmpiricalNoiseModel::configure</a>(<span class="keyword">const</span> <a class="code" href="namespace_wire_cell.html#a9f705541fc1d46c608b3d32c182333ee">WireCell::Configuration</a>&amp; cfg)</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;{</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    m_anode_tn = <span class="keyword">get</span>(cfg, <span class="stringliteral">&quot;anode&quot;</span>, m_anode_tn);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    m_anode = Factory::find_tn&lt;IAnodePlane&gt;(m_anode_tn);</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    m_chanstat_tn = <span class="keyword">get</span>(cfg, <span class="stringliteral">&quot;chanstat&quot;</span>, m_chanstat_tn);</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">if</span> (m_chanstat_tn != <span class="stringliteral">&quot;&quot;</span>) {  <span class="comment">// allow for an empty channel status, no deviation from norm</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    m_chanstat = Factory::find_tn&lt;IChannelStatus&gt;(m_chanstat_tn);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    log-&gt;debug(<span class="stringliteral">&quot;EmpiricalNoiseModel: using anode {}, chanstat {}&quot;</span>, m_anode_tn, m_chanstat_tn);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    m_spectra_file = <span class="keyword">get</span>(cfg, <span class="stringliteral">&quot;spectra_file&quot;</span>, m_spectra_file);</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        </div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    m_nsamples = <span class="keyword">get</span>(cfg, <span class="stringliteral">&quot;nsamples&quot;</span>, m_nsamples);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    m_fft_length = <a class="code" href="namespace_wire_cell.html#abb6bcae83d0f22d52565724179e9dcd8">fft_best_length</a>(m_nsamples);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="comment">//m_fft_length = m_nsamples;</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    m_period = <span class="keyword">get</span>(cfg, <span class="stringliteral">&quot;period&quot;</span>, m_period);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    m_wlres = <span class="keyword">get</span>(cfg, <span class="stringliteral">&quot;wire_length_scale&quot;</span>, m_wlres);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="comment">// m_tres = get(cfg, &quot;time_scale&quot;, m_tres);</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="comment">// m_gres = get(cfg, &quot;gain_scale&quot;, m_gres);</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <span class="comment">// m_fres = get(cfg, &quot;freq_scale&quot;, m_fres);</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">// Load the data file assuming.  The file should be a list of</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// dictionaries matching the</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// wirecell.sigproc.noise.schema.NoiseSpectrum class.  Fixme:</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <span class="comment">// should break out this code separate.</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keyword">auto</span> jdat = <a class="code" href="namespace_wire_cell_1_1_persist.html#ab922ff3e9c80bcbc9d4e8342f7d3223d">Persist::load</a>(m_spectra_file);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nentries = jdat.size();</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    m_spectral_data.clear();</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#abf5f2823eb9522997306417ddd1d9ca4">gen_elec_resp_default</a>();</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    </div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ientry=0; ientry&lt;nentries; ++ientry) {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keyword">auto</span> jentry = jdat[ientry];</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html">NoiseSpectrum</a> *nsptr = <span class="keyword">new</span> <a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html">NoiseSpectrum</a>();</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        nsptr-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#af4b3a452d3cc525401482d214132565a">plane</a> = jentry[<span class="stringliteral">&quot;plane&quot;</span>].asInt();</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        nsptr-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a29ae414d6739f6d639dfee7e7540a404">nsamples</a> = jentry[<span class="stringliteral">&quot;nsamples&quot;</span>].asInt();</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        nsptr-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#aed82c7a61bd3901c3ad7dce02041f51e">period</a> = jentry[<span class="stringliteral">&quot;period&quot;</span>].asFloat();<span class="comment">// * m_tres;  </span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        nsptr-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#ad3b40eb570b2ccbb93fee79da5b4817c">gain</a> = jentry[<span class="stringliteral">&quot;gain&quot;</span>].asFloat();<span class="comment">// *m_gres;    </span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        nsptr-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#ab76b726184c0744b3b16e8bc0483a662">shaping</a> = jentry[<span class="stringliteral">&quot;shaping&quot;</span>].asFloat();<span class="comment">// * m_tres; </span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        nsptr-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a866c884789cd4d3f14816584d4019be2">wirelen</a> = jentry[<span class="stringliteral">&quot;wirelen&quot;</span>].asFloat();<span class="comment">// * m_wlres; </span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        nsptr-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#aba73b1c4021bd3a684e89a1d873cf4bb">constant</a> = jentry[<span class="stringliteral">&quot;const&quot;</span>].asFloat();</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        <span class="keyword">auto</span> jfreqs = jentry[<span class="stringliteral">&quot;freqs&quot;</span>];</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> nfreqs = jfreqs.size();</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        nsptr-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a90d1860adb05adebe9650afd3e019f78">freqs</a>.resize(nfreqs, 0.0);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind=0; ind&lt;nfreqs; ++ind) {</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      nsptr-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a90d1860adb05adebe9650afd3e019f78">freqs</a>[ind] = jfreqs[ind].asFloat();<span class="comment">// * m_fres;</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        }</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keyword">auto</span> jamps = jentry[<span class="stringliteral">&quot;amps&quot;</span>];</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> namps = jamps.size();</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        nsptr-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a91705ef881cd5a2d5de2a09c397518da">amps</a>.resize(namps+1, 0.0);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind=0; ind&lt;namps; ++ind) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            nsptr-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a91705ef881cd5a2d5de2a09c397518da">amps</a>[ind] = jamps[ind].asFloat();</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// put the constant term at the end of the amplitude ... </span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// nsptr-&gt;amps[namps] = nsptr-&gt;constant;</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    </div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a35db0e36d1426041740535fc2da0b07d">resample</a>(*nsptr);</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        m_spectral_data[nsptr-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#af4b3a452d3cc525401482d214132565a">plane</a>].push_back(nsptr); <span class="comment">// assumes ordered by wire length!</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    }        </div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;}</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a5b1d7a97da1b07237cf03b28a2caacdf">  216</a></span>&#160;<a class="code" href="class_wire_cell_1_1_i_channel_spectrum.html#a9af7bfed961f49dc8a532fd5d0bf3e6e">IChannelSpectrum::amplitude_t</a> <a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a5b1d7a97da1b07237cf03b28a2caacdf">Gen::EmpiricalNoiseModel::interpolate</a>(<span class="keywordtype">int</span> iplane, <span class="keywordtype">double</span> wire_length)<span class="keyword"> const</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keyword">auto</span> it = m_spectral_data.find(iplane);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordflow">if</span> (it == m_spectral_data.end()) {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="class_wire_cell_1_1_i_channel_spectrum.html#a9af7bfed961f49dc8a532fd5d0bf3e6e">amplitude_t</a>();</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span>&amp; spectra = it-&gt;second;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    </div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// Linearly interpolate spectral data to wire length.</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="comment">// Any wire lengths</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="comment">// which are out of bounds causes the nearest result to be</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// returned (flat extrapolation)</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html">NoiseSpectrum</a>* front = spectra.front();</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> (wire_length &lt;= front-&gt;wirelen) {</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">return</span> front-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a91705ef881cd5a2d5de2a09c397518da">amps</a>;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keyword">const</span> <a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html">NoiseSpectrum</a>* back = spectra.back();</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">if</span> (wire_length &gt;= back-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a866c884789cd4d3f14816584d4019be2">wirelen</a>) {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">return</span> back-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a91705ef881cd5a2d5de2a09c397518da">amps</a>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nspectra = spectra.size();</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind=1; ind&lt;nspectra; ++ind) {</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keyword">const</span> <a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html">NoiseSpectrum</a>* hi = spectra[ind];</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">if</span> (hi-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a866c884789cd4d3f14816584d4019be2">wirelen</a> &lt; wire_length) {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        }</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keyword">const</span> <a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html">NoiseSpectrum</a>* lo = spectra[ind-1];</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> delta = hi-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a866c884789cd4d3f14816584d4019be2">wirelen</a> - lo-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a866c884789cd4d3f14816584d4019be2">wirelen</a>;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> dist = wire_length - lo-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a866c884789cd4d3f14816584d4019be2">wirelen</a>;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> mu = dist/delta;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> nsamp = lo-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a91705ef881cd5a2d5de2a09c397518da">amps</a>.size();</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <a class="code" href="class_wire_cell_1_1_i_channel_spectrum.html#a9af7bfed961f49dc8a532fd5d0bf3e6e">amplitude_t</a> amp(nsamp);</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isamp=0; isamp&lt;nsamp; ++isamp) { <span class="comment">// regular amplitude ... </span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            amp[isamp] = lo-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a91705ef881cd5a2d5de2a09c397518da">amps</a>[isamp]*(1-mu) + hi-&gt;<a class="code" href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a91705ef881cd5a2d5de2a09c397518da">amps</a>[isamp]*mu;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="comment">// amp[nsamp] = lo-&gt;constant*(1-mu) + hi-&gt;constant*mu; // do the constant term ...</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">return</span> amp;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    }</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="comment">// should not get here</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_wire_cell_1_1_i_channel_spectrum.html#a9af7bfed961f49dc8a532fd5d0bf3e6e">amplitude_t</a>();</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a10ae08668a26ca0818608a4d653dea1c">  266</a></span>&#160;<span class="keyword">const</span> std::vector&lt;float&gt;&amp; <a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a10ae08668a26ca0818608a4d653dea1c">Gen::EmpiricalNoiseModel::freq</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="comment">// assume frequency is universal ... </span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iplane = 0;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <span class="keyword">auto</span> it = m_spectral_data.find(iplane);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; spectra = it-&gt;second;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <span class="keywordflow">return</span> spectra.front()-&gt;freqs;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;}</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;</div><div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#ada27f0991c188eb877a6702bb0878805">  275</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#ada27f0991c188eb877a6702bb0878805">Gen::EmpiricalNoiseModel::shaping_time</a>(<span class="keywordtype">int</span> chid)<span class="keyword"> const</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keyword">auto</span> wpid = m_anode-&gt;resolve(chid);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iplane = wpid.index();</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="keyword">auto</span> it = m_spectral_data.find(iplane);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; spectra = it-&gt;second;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordflow">return</span> spectra.front()-&gt;shaping;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;}</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a783b81a925de0823c63ade8b242033e8">  284</a></span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a783b81a925de0823c63ade8b242033e8">Gen::EmpiricalNoiseModel::gain</a>(<span class="keywordtype">int</span> chid)<span class="keyword"> const</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keyword">auto</span> wpid = m_anode-&gt;resolve(chid);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iplane = wpid.index();</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keyword">auto</span> it = m_spectral_data.find(iplane);</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; spectra = it-&gt;second;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keywordflow">return</span> spectra.front()-&gt;gain;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno"><a class="line" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a9ed3c28256c1c262064c62816b4b225f">  295</a></span>&#160;<span class="keyword">const</span> <a class="code" href="class_wire_cell_1_1_i_channel_spectrum.html#a9af7bfed961f49dc8a532fd5d0bf3e6e">IChannelSpectrum::amplitude_t</a>&amp; <a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a9ed3c28256c1c262064c62816b4b225f">Gen::EmpiricalNoiseModel::operator()</a>(<span class="keywordtype">int</span> chid)<span class="keyword"> const</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="comment">// get truncated wire length for cache</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordtype">int</span> ilen=0;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keyword">auto</span> chlen = m_chid_to_intlen.find(chid);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">if</span> (chlen == m_chid_to_intlen.end()) {  <span class="comment">// new channel</span></div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        <span class="keyword">auto</span> wires =  m_anode-&gt;wires(chid); <span class="comment">// sum up wire length</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordtype">double</span> len = 0.0;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> wire : wires) {</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            len += <a class="code" href="namespace_wire_cell.html#a078ec264f4f9f82fe3e6ba21b2108d00">ray_length</a>(wire-&gt;ray());</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        }</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="comment">// cache every cm ...</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    ilen = int(len/m_wlres);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="comment">// there might be  aproblem with the wire length&#39;s unit</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">//ilen = int(len);</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        m_chid_to_intlen[chid] = ilen;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    }</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        ilen = chlen-&gt;second;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="comment">// saved content</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keyword">auto</span> wpid = m_anode-&gt;resolve(chid);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> iplane = wpid.index();</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keyword">auto</span>&amp; amp_cache = m_amp_cache.at(iplane);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="keyword">auto</span> lenamp = amp_cache.find(ilen);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">if</span> (lenamp == amp_cache.end()) {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      <span class="keyword">auto</span> amp = <a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a5b1d7a97da1b07237cf03b28a2caacdf">interpolate</a>(iplane, ilen*m_wlres); <span class="comment">// interpolate ... </span></div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      amp_cache[ilen] = amp;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    lenamp = amp_cache.find(ilen);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    </div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// prepare to scale ... </span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">double</span> db_gain = <a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a783b81a925de0823c63ade8b242033e8">gain</a>(chid);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordtype">double</span> db_shaping = <a class="code" href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#ada27f0991c188eb877a6702bb0878805">shaping_time</a>(chid);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">// get channel gain</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">//float ch_gain = 14 * units::mV/units::fC, ch_shaping = 2.0 * units::us; </span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    </div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordtype">double</span> ch_gain = db_gain, ch_shaping = db_shaping;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">if</span> (m_chanstat) {       <span class="comment">// allow for deviation from nominal</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    ch_gain = m_chanstat-&gt;preamp_gain(chid);</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    ch_shaping = m_chanstat-&gt;preamp_shaping(chid);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keywordtype">double</span> constant = lenamp-&gt;second.back();</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordtype">int</span> nbin = lenamp-&gt;second.size()-1;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">//    amplitude_t comb_amp;</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    comb_amp = lenamp-&gt;second;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    comb_amp.pop_back();</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    </div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">if</span> (fabs(ch_gain - db_gain ) &gt; 0.01 * ch_gain){</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <span class="comment">// scale the amplitude, not the constant term ...  </span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i!=nbin;i++){</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    comb_amp.at(i) *= ch_gain/db_gain;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      }</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    </div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="keywordflow">if</span> (fabs(ch_shaping-db_shaping) &gt; 0.01*ch_shaping){</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="comment">// scale the amplitude by different shaping time ...   </span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordtype">int</span> nconfig = ch_shaping/units::us/0.1;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      <span class="keyword">auto</span> resp1 = m_elec_resp_cache.find(nconfig);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="keywordflow">if</span> (resp1 == m_elec_resp_cache.end()){</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    <a class="code" href="class_wire_cell_1_1_response_1_1_cold_elec.html">Response::ColdElec</a> elec_resp(10, ch_shaping); <span class="comment">// default at 1 mV/fC</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keyword">auto</span> sig   =   elec_resp.<a class="code" href="class_wire_cell_1_1_response_1_1_generator.html#aceed932e0bab5af1cb80981507667e5e">generate</a>(<a class="code" href="namespace_wire_cell_1_1_waveform.html#aa783b1c2a84242349d5c798b7483727b">WireCell::Waveform::Domain</a>(0, m_fft_length*m_period), m_fft_length);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keyword">auto</span> filt   = <a class="code" href="namespace_wire_cell_1_1_waveform.html#a6cfae9f74c1bf06f69d6991f3f82cef5">Waveform::dft</a>(sig);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keyword">auto</span> ele_resp_amp = <a class="code" href="namespace_wire_cell_1_1_waveform.html#ae8dc1c86082f99f8cbfedb8434d22bc2">Waveform::magnitude</a>(filt);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    ele_resp_amp.resize(m_elec_resp_freq.size());</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    m_elec_resp_cache[nconfig] = ele_resp_amp;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      }</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      resp1 = m_elec_resp_cache.find(nconfig);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      </div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      nconfig = db_shaping/units::us/0.1;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="keyword">auto</span> resp2 = m_elec_resp_cache.find(nconfig);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="keywordflow">if</span> (resp2 == m_elec_resp_cache.end()){</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="class_wire_cell_1_1_response_1_1_cold_elec.html">Response::ColdElec</a> elec_resp(10, db_shaping); <span class="comment">// default at 1 mV/fC</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keyword">auto</span> sig   =   elec_resp.<a class="code" href="class_wire_cell_1_1_response_1_1_generator.html#aceed932e0bab5af1cb80981507667e5e">generate</a>(<a class="code" href="namespace_wire_cell_1_1_waveform.html#aa783b1c2a84242349d5c798b7483727b">WireCell::Waveform::Domain</a>(0, m_fft_length*m_period), m_fft_length);</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keyword">auto</span> filt   = <a class="code" href="namespace_wire_cell_1_1_waveform.html#a6cfae9f74c1bf06f69d6991f3f82cef5">Waveform::dft</a>(sig);</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keyword">auto</span> ele_resp_amp = <a class="code" href="namespace_wire_cell_1_1_waveform.html#ae8dc1c86082f99f8cbfedb8434d22bc2">Waveform::magnitude</a>(filt);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    ele_resp_amp.resize(m_elec_resp_freq.size());</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    m_elec_resp_cache[nconfig] = ele_resp_amp;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      }</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      resp2 = m_elec_resp_cache.find(nconfig);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      </div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i!=nbin;i++){</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    comb_amp.at(i) *= resp1-&gt;second.at(i)/resp2-&gt;second.at(i);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      }</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      </div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    }</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    </div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    </div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">// add the constant terms ... </span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i!=nbin;i++){</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      comb_amp.at(i) = sqrt(pow(comb_amp.at(i),2) + pow(constant,2)); <span class="comment">// units still in mV</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keywordflow">return</span> comb_amp;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;}</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="ttc" id="namespace_wire_cell_html"><div class="ttname"><a href="namespace_wire_cell.html">WireCell</a></div><div class="ttdef"><b>Definition:</b> <a href="_main_8h_source.html#l00022">Main.h:22</a></div></div>
<div class="ttc" id="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum_html_af4b3a452d3cc525401482d214132565a"><div class="ttname"><a href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#af4b3a452d3cc525401482d214132565a">WireCell::Gen::EmpiricalNoiseModel::NoiseSpectrum::plane</a></div><div class="ttdeci">int plane</div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8h_source.html#l00065">EmpiricalNoiseModel.h:65</a></div></div>
<div class="ttc" id="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum_html_ad3b40eb570b2ccbb93fee79da5b4817c"><div class="ttname"><a href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#ad3b40eb570b2ccbb93fee79da5b4817c">WireCell::Gen::EmpiricalNoiseModel::NoiseSpectrum::gain</a></div><div class="ttdeci">double gain</div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8h_source.html#l00068">EmpiricalNoiseModel.h:68</a></div></div>
<div class="ttc" id="namespace_wire_cell_html_abb6bcae83d0f22d52565724179e9dcd8"><div class="ttname"><a href="namespace_wire_cell.html#abb6bcae83d0f22d52565724179e9dcd8">WireCell::fft_best_length</a></div><div class="ttdeci">std::size_t fft_best_length(size_t nsamples, bool keep_odd_even=false)</div></div>
<div class="ttc" id="_response_8h_html"><div class="ttname"><a href="_response_8h.html">Response.h</a></div></div>
<div class="ttc" id="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum_html_a91705ef881cd5a2d5de2a09c397518da"><div class="ttname"><a href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a91705ef881cd5a2d5de2a09c397518da">WireCell::Gen::EmpiricalNoiseModel::NoiseSpectrum::amps</a></div><div class="ttdeci">std::vector&lt; float &gt; amps</div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8h_source.html#l00073">EmpiricalNoiseModel.h:73</a></div></div>
<div class="ttc" id="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum_html_a29ae414d6739f6d639dfee7e7540a404"><div class="ttname"><a href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a29ae414d6739f6d639dfee7e7540a404">WireCell::Gen::EmpiricalNoiseModel::NoiseSpectrum::nsamples</a></div><div class="ttdeci">int nsamples</div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8h_source.html#l00066">EmpiricalNoiseModel.h:66</a></div></div>
<div class="ttc" id="class_wire_cell_1_1_gen_1_1_empirical_noise_model_html_a783b81a925de0823c63ade8b242033e8"><div class="ttname"><a href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a783b81a925de0823c63ade8b242033e8">WireCell::Gen::EmpiricalNoiseModel::gain</a></div><div class="ttdeci">virtual const double gain(int chid) const</div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8cxx_source.html#l00284">EmpiricalNoiseModel.cxx:284</a></div></div>
<div class="ttc" id="namespace_wire_cell_1_1_waveform_html_a6cfae9f74c1bf06f69d6991f3f82cef5"><div class="ttname"><a href="namespace_wire_cell_1_1_waveform.html#a6cfae9f74c1bf06f69d6991f3f82cef5">WireCell::Waveform::dft</a></div><div class="ttdeci">compseq_t dft(realseq_t seq)</div><div class="ttdef"><b>Definition:</b> <a href="_waveform_8cxx_source.html#l00143">Waveform.cxx:143</a></div></div>
<div class="ttc" id="class_wire_cell_1_1_gen_1_1_empirical_noise_model_html_a10ae08668a26ca0818608a4d653dea1c"><div class="ttname"><a href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a10ae08668a26ca0818608a4d653dea1c">WireCell::Gen::EmpiricalNoiseModel::freq</a></div><div class="ttdeci">virtual const std::vector&lt; float &gt; &amp; freq() const</div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8cxx_source.html#l00266">EmpiricalNoiseModel.cxx:266</a></div></div>
<div class="ttc" id="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum_html"><div class="ttname"><a href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html">WireCell::Gen::EmpiricalNoiseModel::NoiseSpectrum</a></div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8h_source.html#l00064">EmpiricalNoiseModel.h:64</a></div></div>
<div class="ttc" id="_empirical_noise_model_8h_html"><div class="ttname"><a href="_empirical_noise_model_8h.html">EmpiricalNoiseModel.h</a></div></div>
<div class="ttc" id="class_wire_cell_1_1_gen_1_1_empirical_noise_model_html_a3478b5daf202fbb7f923664ac21fdeb5"><div class="ttname"><a href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a3478b5daf202fbb7f923664ac21fdeb5">WireCell::Gen::EmpiricalNoiseModel::EmpiricalNoiseModel</a></div><div class="ttdeci">EmpiricalNoiseModel(const std::string &amp;spectra_file=&quot;&quot;, const int nsamples=10000, const double period=0.5 *units::us, const double wire_length_scale=1.0 *units::cm, const std::string anode_tn=&quot;AnodePlane&quot;, const std::string chanstat_tn=&quot;StaticChannelStatus&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8cxx_source.html#l00021">EmpiricalNoiseModel.cxx:21</a></div></div>
<div class="ttc" id="class_wire_cell_1_1_i_configurable_html"><div class="ttname"><a href="class_wire_cell_1_1_i_configurable.html">WireCell::IConfigurable</a></div><div class="ttdef"><b>Definition:</b> <a href="_i_configurable_8h_source.html#l00013">IConfigurable.h:13</a></div></div>
<div class="ttc" id="_empirical_noise_model_8cxx_html_a2d3f3d46427dca1947cac1f0fc5f7000"><div class="ttname"><a href="_empirical_noise_model_8cxx.html#a2d3f3d46427dca1947cac1f0fc5f7000">WIRECELL_FACTORY</a></div><div class="ttdeci">WIRECELL_FACTORY(EmpiricalNoiseModel, WireCell::Gen::EmpiricalNoiseModel, WireCell::IChannelSpectrum, WireCell::IConfigurable) using namespace WireCell</div></div>
<div class="ttc" id="class_wire_cell_1_1_response_1_1_cold_elec_html"><div class="ttname"><a href="class_wire_cell_1_1_response_1_1_cold_elec.html">WireCell::Response::ColdElec</a></div><div class="ttdoc">A functional object caching gain and shape. </div><div class="ttdef"><b>Definition:</b> <a href="_response_8h_source.html#l00165">Response.h:165</a></div></div>
<div class="ttc" id="namespace_wire_cell_1_1_log_html_a7675bcc4bf25b2bc66314d5c096cf676"><div class="ttname"><a href="namespace_wire_cell_1_1_log.html#a7675bcc4bf25b2bc66314d5c096cf676">WireCell::Log::logger</a></div><div class="ttdeci">logptr_t logger(std::string name)</div><div class="ttdef"><b>Definition:</b> <a href="_logging_8cxx_source.html#l00071">Logging.cxx:71</a></div></div>
<div class="ttc" id="class_wire_cell_1_1_gen_1_1_empirical_noise_model_html_a5b1d7a97da1b07237cf03b28a2caacdf"><div class="ttname"><a href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a5b1d7a97da1b07237cf03b28a2caacdf">WireCell::Gen::EmpiricalNoiseModel::interpolate</a></div><div class="ttdeci">amplitude_t interpolate(int plane, double wire_length) const</div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8cxx_source.html#l00216">EmpiricalNoiseModel.cxx:216</a></div></div>
<div class="ttc" id="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum_html_a866c884789cd4d3f14816584d4019be2"><div class="ttname"><a href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a866c884789cd4d3f14816584d4019be2">WireCell::Gen::EmpiricalNoiseModel::NoiseSpectrum::wirelen</a></div><div class="ttdeci">double wirelen</div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8h_source.html#l00070">EmpiricalNoiseModel.h:70</a></div></div>
<div class="ttc" id="_named_factory_8h_html"><div class="ttname"><a href="_named_factory_8h.html">NamedFactory.h</a></div></div>
<div class="ttc" id="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum_html_aed82c7a61bd3901c3ad7dce02041f51e"><div class="ttname"><a href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#aed82c7a61bd3901c3ad7dce02041f51e">WireCell::Gen::EmpiricalNoiseModel::NoiseSpectrum::period</a></div><div class="ttdeci">double period</div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8h_source.html#l00067">EmpiricalNoiseModel.h:67</a></div></div>
<div class="ttc" id="class_wire_cell_1_1_gen_1_1_empirical_noise_model_html_a683bdf03c14c78ff74b12a844a688c61"><div class="ttname"><a href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a683bdf03c14c78ff74b12a844a688c61">WireCell::Gen::EmpiricalNoiseModel::default_configuration</a></div><div class="ttdeci">virtual WireCell::Configuration default_configuration() const</div><div class="ttdoc">Optional, override to return a hard-coded default configuration. </div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8cxx_source.html#l00080">EmpiricalNoiseModel.cxx:80</a></div></div>
<div class="ttc" id="class_wire_cell_1_1_gen_1_1_empirical_noise_model_html_ada27f0991c188eb877a6702bb0878805"><div class="ttname"><a href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#ada27f0991c188eb877a6702bb0878805">WireCell::Gen::EmpiricalNoiseModel::shaping_time</a></div><div class="ttdeci">virtual const double shaping_time(int chid) const</div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8cxx_source.html#l00275">EmpiricalNoiseModel.cxx:275</a></div></div>
<div class="ttc" id="class_wire_cell_1_1_gen_1_1_empirical_noise_model_html_a9ed3c28256c1c262064c62816b4b225f"><div class="ttname"><a href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a9ed3c28256c1c262064c62816b4b225f">WireCell::Gen::EmpiricalNoiseModel::operator()</a></div><div class="ttdeci">virtual const amplitude_t &amp; operator()(int chid) const</div><div class="ttdoc">IChannelSpectrum. </div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8cxx_source.html#l00295">EmpiricalNoiseModel.cxx:295</a></div></div>
<div class="ttc" id="class_wire_cell_1_1_gen_1_1_empirical_noise_model_html_a4de4558ce8eb7aa69193a315741eadc6"><div class="ttname"><a href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a4de4558ce8eb7aa69193a315741eadc6">WireCell::Gen::EmpiricalNoiseModel::~EmpiricalNoiseModel</a></div><div class="ttdeci">virtual ~EmpiricalNoiseModel()</div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8cxx_source.html#l00048">EmpiricalNoiseModel.cxx:48</a></div></div>
<div class="ttc" id="class_wire_cell_1_1_gen_1_1_empirical_noise_model_html"><div class="ttname"><a href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html">WireCell::Gen::EmpiricalNoiseModel</a></div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8h_source.html#l00031">EmpiricalNoiseModel.h:31</a></div></div>
<div class="ttc" id="namespace_wire_cell_1_1_persist_html_ab922ff3e9c80bcbc9d4e8342f7d3223d"><div class="ttname"><a href="namespace_wire_cell_1_1_persist.html#ab922ff3e9c80bcbc9d4e8342f7d3223d">WireCell::Persist::load</a></div><div class="ttdeci">Json::Value load(const std::string &amp;filename, const externalvars_t &amp;extvar=externalvars_t(), const externalvars_t &amp;extcode=externalvars_t())</div><div class="ttdef"><b>Definition:</b> <a href="_persist_8cxx_source.html#l00121">Persist.cxx:121</a></div></div>
<div class="ttc" id="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum_html_aba73b1c4021bd3a684e89a1d873cf4bb"><div class="ttname"><a href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#aba73b1c4021bd3a684e89a1d873cf4bb">WireCell::Gen::EmpiricalNoiseModel::NoiseSpectrum::constant</a></div><div class="ttdeci">double constant</div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8h_source.html#l00071">EmpiricalNoiseModel.h:71</a></div></div>
<div class="ttc" id="namespace_wire_cell_1_1_waveform_html_aa8d25ae88346929b5e54cd116f7a4f47"><div class="ttname"><a href="namespace_wire_cell_1_1_waveform.html#aa8d25ae88346929b5e54cd116f7a4f47">WireCell::Waveform::scale</a></div><div class="ttdeci">void scale(Sequence&lt; Val &gt; &amp;seq, Val scalar)</div><div class="ttdoc">Scale (multiply) sequence values by scalar. </div><div class="ttdef"><b>Definition:</b> <a href="_waveform_8h_source.html#l00146">Waveform.h:146</a></div></div>
<div class="ttc" id="class_wire_cell_1_1_gen_1_1_empirical_noise_model_html_aa38f65fc1f32c8017f8205b32850074e"><div class="ttname"><a href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#aa38f65fc1f32c8017f8205b32850074e">WireCell::Gen::EmpiricalNoiseModel::configure</a></div><div class="ttdeci">virtual void configure(const WireCell::Configuration &amp;config)</div><div class="ttdoc">IConfigurable. </div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8cxx_source.html#l00150">EmpiricalNoiseModel.cxx:150</a></div></div>
<div class="ttc" id="namespace_wire_cell_html_a078ec264f4f9f82fe3e6ba21b2108d00"><div class="ttname"><a href="namespace_wire_cell.html#a078ec264f4f9f82fe3e6ba21b2108d00">WireCell::ray_length</a></div><div class="ttdeci">double ray_length(const Ray &amp;ray)</div><div class="ttdef"><b>Definition:</b> <a href="_point_8cxx_source.html#l00062">Point.cxx:62</a></div></div>
<div class="ttc" id="namespace_wire_cell_html_a9f705541fc1d46c608b3d32c182333ee"><div class="ttname"><a href="namespace_wire_cell.html#a9f705541fc1d46c608b3d32c182333ee">WireCell::Configuration</a></div><div class="ttdeci">Json::Value Configuration</div><div class="ttdef"><b>Definition:</b> <a href="_configuration_8h_source.html#l00050">Configuration.h:50</a></div></div>
<div class="ttc" id="class_wire_cell_1_1_gen_1_1_empirical_noise_model_html_a35db0e36d1426041740535fc2da0b07d"><div class="ttname"><a href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#a35db0e36d1426041740535fc2da0b07d">WireCell::Gen::EmpiricalNoiseModel::resample</a></div><div class="ttdeci">void resample(NoiseSpectrum &amp;spectrum) const</div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8cxx_source.html#l00097">EmpiricalNoiseModel.cxx:97</a></div></div>
<div class="ttc" id="namespace_wire_cell_1_1_waveform_html_aa783b1c2a84242349d5c798b7483727b"><div class="ttname"><a href="namespace_wire_cell_1_1_waveform.html#aa783b1c2a84242349d5c798b7483727b">WireCell::Waveform::Domain</a></div><div class="ttdeci">std::pair&lt; double, double &gt; Domain</div><div class="ttdef"><b>Definition:</b> <a href="_waveform_8h_source.html#l00075">Waveform.h:75</a></div></div>
<div class="ttc" id="_f_f_t_best_length_8h_html"><div class="ttname"><a href="_f_f_t_best_length_8h.html">FFTBestLength.h</a></div></div>
<div class="ttc" id="class_wire_cell_1_1_gen_1_1_empirical_noise_model_html_abf5f2823eb9522997306417ddd1d9ca4"><div class="ttname"><a href="class_wire_cell_1_1_gen_1_1_empirical_noise_model.html#abf5f2823eb9522997306417ddd1d9ca4">WireCell::Gen::EmpiricalNoiseModel::gen_elec_resp_default</a></div><div class="ttdeci">void gen_elec_resp_default()</div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8cxx_source.html#l00052">EmpiricalNoiseModel.cxx:52</a></div></div>
<div class="ttc" id="class_wire_cell_1_1_response_1_1_generator_html_aceed932e0bab5af1cb80981507667e5e"><div class="ttname"><a href="class_wire_cell_1_1_response_1_1_generator.html#aceed932e0bab5af1cb80981507667e5e">WireCell::Response::Generator::generate</a></div><div class="ttdeci">WireCell::Waveform::realseq_t generate(const WireCell::Waveform::Domain &amp;domain, int nsamples)</div><div class="ttdoc">FIXME: eradicate Domain in favor of Binning. </div><div class="ttdef"><b>Definition:</b> <a href="_response_8cxx_source.html#l00303">Response.cxx:303</a></div></div>
<div class="ttc" id="_persist_8h_html"><div class="ttname"><a href="_persist_8h.html">Persist.h</a></div></div>
<div class="ttc" id="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum_html_ab76b726184c0744b3b16e8bc0483a662"><div class="ttname"><a href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#ab76b726184c0744b3b16e8bc0483a662">WireCell::Gen::EmpiricalNoiseModel::NoiseSpectrum::shaping</a></div><div class="ttdeci">double shaping</div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8h_source.html#l00069">EmpiricalNoiseModel.h:69</a></div></div>
<div class="ttc" id="class_wire_cell_1_1_i_channel_spectrum_html_a9af7bfed961f49dc8a532fd5d0bf3e6e"><div class="ttname"><a href="class_wire_cell_1_1_i_channel_spectrum.html#a9af7bfed961f49dc8a532fd5d0bf3e6e">WireCell::IChannelSpectrum::amplitude_t</a></div><div class="ttdeci">std::vector&lt; float &gt; amplitude_t</div><div class="ttdef"><b>Definition:</b> <a href="_i_channel_spectrum_8h_source.html#l00027">IChannelSpectrum.h:27</a></div></div>
<div class="ttc" id="class_wire_cell_1_1_i_channel_spectrum_html"><div class="ttname"><a href="class_wire_cell_1_1_i_channel_spectrum.html">WireCell::IChannelSpectrum</a></div><div class="ttdef"><b>Definition:</b> <a href="_i_channel_spectrum_8h_source.html#l00017">IChannelSpectrum.h:17</a></div></div>
<div class="ttc" id="_configuration_8h_html"><div class="ttname"><a href="_configuration_8h.html">Configuration.h</a></div></div>
<div class="ttc" id="_exceptions_8h_html"><div class="ttname"><a href="_exceptions_8h.html">Exceptions.h</a></div></div>
<div class="ttc" id="namespace_wire_cell_1_1_waveform_html_ae8dc1c86082f99f8cbfedb8434d22bc2"><div class="ttname"><a href="namespace_wire_cell_1_1_waveform.html#ae8dc1c86082f99f8cbfedb8434d22bc2">WireCell::Waveform::magnitude</a></div><div class="ttdeci">realseq_t magnitude(const compseq_t &amp;seq)</div><div class="ttdoc">Return the magnitude or absolute value of the sequence. </div><div class="ttdef"><b>Definition:</b> <a href="_waveform_8cxx_source.html#l00065">Waveform.cxx:65</a></div></div>
<div class="ttc" id="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum_html_a90d1860adb05adebe9650afd3e019f78"><div class="ttname"><a href="struct_wire_cell_1_1_gen_1_1_empirical_noise_model_1_1_noise_spectrum.html#a90d1860adb05adebe9650afd3e019f78">WireCell::Gen::EmpiricalNoiseModel::NoiseSpectrum::freqs</a></div><div class="ttdeci">std::vector&lt; float &gt; freqs</div><div class="ttdef"><b>Definition:</b> <a href="_empirical_noise_model_8h_source.html#l00072">EmpiricalNoiseModel.h:72</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_76d06afa57792f775bcb80774dbca277.html">gen</a></li><li class="navelem"><a class="el" href="dir_9dc077e255f1d6bcaab6b89fb4556bb0.html">src</a></li><li class="navelem"><a class="el" href="_empirical_noise_model_8cxx.html">EmpiricalNoiseModel.cxx</a></li>
    <li class="footer">Generated on Mon Jul 22 2019 10:47:02 for WireCellToolkit by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.13 </li>
  </ul>
</div>
</body>
</html>
